function loadQuiz(p,m){fetch(p,{cache:'no-store'}).then(r=>r.json()).then(items=>{const root=document.querySelector(m);root.innerHTML='';const ol=document.createElement('ol');items.forEach((q,i)=>{const li=document.createElement('li');const s=document.createElement('span');s.textContent=q.question;s.style.textDecoration='underline';s.style.textUnderlineOffset='2px';s.onclick=()=>window.speak&&speak(q.say||q.question);li.appendChild(s);q.options.forEach((opt,j)=>{const lab=document.createElement('label');const inp=document.createElement('input');inp.type='radio';inp.name='q'+i;inp.value=String.fromCharCode(65+j);if(j===q.answer)inp.dataset.answer='1';lab.appendChild(inp);const sp=document.createElement('span');sp.textContent=(typeof opt==='string')?opt:(opt.text||'');sp.style.textDecoration='underline';sp.style.textUnderlineOffset='2px';sp.onclick=()=>window.speak&&speak((typeof opt==='string')?opt:(opt.say||opt.text||''));lab.appendChild(sp);li.appendChild(lab);li.appendChild(document.createElement('br'));});ol.appendChild(li);});root.appendChild(ol);const btn=document.createElement('button');btn.textContent='批改';btn.onclick=()=>{let ok=0,groups=new Set();document.querySelectorAll('.qz input[type=radio]').forEach(r=>groups.add(r.name));groups=[...groups];groups.forEach(g=>{const p=document.querySelector('input[name='+g+']:checked');const a=document.querySelector('input[name='+g+'][data-answer="1"]');if(p&&a&&p.value===a.value)ok++;});let sc=document.getElementById('quiz-score');if(!sc){sc=document.createElement('span');sc.id='quiz-score';btn.after(sc);}sc.textContent=' 分數：'+ok+' / '+groups.length;};root.appendChild(btn);}).catch(e=>{document.querySelector(m).innerHTML='<p style="color:#b00">題庫載入失敗：'+e.message+'</p>';});}